# タップ主体インクリメンタルRPG 設計書

## 0. 技術スタック

- **フレームワーク**: Next.js（Webアプリ）
- **言語**: TypeScript
- **プラットフォーム**: Web（モバイルブラウザ主体）
- **テスト**: Vitest
- **デプロイ**: Vercel

## 0.1 開発方針

- 機能ごとに別ブランチを切って開発する
- 各ブランチはテスト可能で動作確認できる単位にする
- テストを書いてから実装（またはテストと同時に実装）
- 動作確認が取れたらmainにマージ
- 実装計画は `plan/` フォルダで管理

## 1. ゲーム概要

### ジャンル
- タップ主体のインクリメンタルRPG
- ローグライク寄り設計
- 短時間プレイ＆リプレイ前提

### 基本思想
- 序盤は通常RPGスケール
- 中盤以降は指数インフレ
- 操作はタップのみ
- 戦略は属性相性＋イベント選択（未来予測）

## 2. コアゲームループ

1. 一本道を1マス進む（Moveタップ）
2. イベント発生
   - 戦闘
   - 回復
   - 宝箱
   - 罠
3. 戦闘なら攻撃タップ
4. 勝利でEXP／ゴールド／武器ドロップ
5. 8マス進むとエリアボス
6. ボス撃破で次エリア
7. HP0で死亡→最初から

## 3. エリア構成（固定8エリア）

| # | エリア名 |
|---|----------|
| 1 | 草原 |
| 2 | 山間部 |
| 3 | 洞窟 |
| 4 | 呪われた森 |
| 5 | 亡者の湿地 |
| 6 | 黒曜の火山 |
| 7 | 魔界の門前 |
| 8 | 魔王城（最終） |

### 各エリアが持つ要素
- 敵レベル補正
- 敵HP倍率
- 敵ATK倍率
- 報酬倍率
- 属性出現分布
- 異常個体出現率
- ボス倍率

後半ほど指数的に強化。

## 4. マップ進行仕様

- 各エリアは8マス構成
- 1マス＝1イベント
- 8マス目は必ずボス
- ボス撃破で次エリア
- 魔王城ボス撃破でクリア（その後最初から）

## 5. イベント設計

### イベント種別
- **Battle**（戦闘）
- **Rest**（回復）
- **Treasure**（EXP/Gold）
- **Trap**（ダメージ）
- **Boss**（8マス目固定）

出現はエリアごとに確率テーブル管理。

## 7. プレイヤーステータス

- Level
- EXP / 次Lv必要EXP
- HP / MaxHP
- ATK
- Gold
- Weapon（1本のみ）

内部数値は任意精度整数前提。

## 8. 成長曲線

### 序盤
- 二次関数的な緩やか成長

### 中盤以降
- EXP要求に指数要素追加
- 敵HPも指数増加
- レベルアップ時成長量も段階増加

### 目的
- 桁インフレの快感

## 9. 武器システム

### 所持
- 常に1本のみ
- インベントリなし

### 入手
- 敵撃破時ほぼ確実ドロップ
- ボスは確定ドロップ

### 更新
- 新武器入手＝即装備更新

### 武器データ
- 属性（水/土/雷）
- 攻撃補正値

### 初期武器
- 属性ランダムの「棒」

## 10. 属性システム

属性:
- 水
- 土
- 雷

敵と武器のみ持つ。

## 11. 属性相性

- 水 ＞ 土
- 土 ＞ 雷
- 雷 ＞ 水

固定ループ。

## 12. ダメージ倍率

| 相性 | 倍率 |
|------|------|
| 有利 | ×2 |
| 不利 | ×0.1 |
| 同属性 | ×1 |

プレイヤー→敵ダメージにのみ適用。

## 13. 敵ランダム個体差

### 構成
敵ステータス＝基礎値 × 個体補正

### 13-1 通常個体補正

後半ほど振れ幅増大。

倍率例:
- 草原：0.85〜1.15
- 魔王城：0.5〜2.6

分布は弱め寄り。

### 13-2 異常個体（極端に強い）

出現率（エリア後半ほど上昇）:
- 草原: 0.05%
- 魔王城: 1.8%

倍率Tier:
- ×8
- ×20
- ×60
- ×150（超低確率）

撃破時:
- 経験値100倍（固定仕様）

## 14. 敵属性分布

- 単属性のみ
- エリアごとに偏りあり

例:
- 火山＝水多め
- 洞窟＝雷多め
- 魔王城＝均等

## 15. 戦闘仕様

- タップ＝攻撃
- 敵は一定間隔で自動攻撃
- 罠でもHP減少
- HP0で死亡

## 16. 死亡とリスタート

### 死亡条件
- HP ≤ 0

### 死亡時
- 全進行リセット
- 草原Lv1から再開

### セーブ
- 生存中のみ保持
- 死亡で初期化

ローグライク型。

## 17. UI必須表示

### 探索画面
- 現在エリア
- 現在マス（1〜8）
- 次3イベント

### 戦闘画面
- 敵属性
- 武器属性
- 相性表示
- 倍率表示
- 敵HPバー
- プレイヤーHP
- 攻撃ボタン

### 異常個体時
- 特別表示
- EXP×100表示

## 18. 設計上の特徴（まとめ）

このゲームは:
- 一本道テンポ重視
- 属性相性が戦略核
- 武器更新が重要
- 未来予測でリスク管理
- 異常個体がスパイス
- 死亡前提で何度も挑戦
- 後半は桁インフレで爽快感

という設計。
